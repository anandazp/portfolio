---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import { render } from "astro:content";

import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import MiniCard from "../../components/ui/MiniCard.astro";
import Button from "../../components/ui/Button.astro";
import { Image } from "astro:assets";

export const getStaticPaths = (async () => {
  const projects = await getCollection("projects");

  return projects.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}) satisfies GetStaticPaths;

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<BaseLayout title={entry.data.title}>
  <Header />
  <main class="px-5 md:px-10 py-5 mt-5 text-blackdark space-y-3">
    <a
      href="/"
      class="inline-flex items-center bg-blackdark text-whitelight px-2 py-1.5 gap-2 rounded-sm cursor-pointer"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        fill="#eceff4"
        viewBox="0 0 256 256"
        ><path
          d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"
        ></path></svg
      >
      Back to projects</a
    >
    <Image src={entry.data.image} alt={entry.data.alt} class="rounded mt-2" />
    <h1 class="text-4xl lg:text-5xl font-semibold mt-5 mb-3">
      {entry.data.title}
    </h1>
    <h2 class="text-lg lg:text-xl">{entry.data.description}</h2>
    <div>
      <h3 class="text-3xl font-medium mt-5 mb-3">Overview</h3>
      <Content />
    </div>
    <h3 class="text-3xl font-medium mt-5 mb-3">Tech Stack</h3>
    <div class="flex flex-wrap gap-2">
      {entry.data.tech.map((t) => <MiniCard label={t} />)}
    </div>
    <section class="grid grid-cols-1 md:grid-cols-2">
      <div>
        <h3 class="text-3xl font-medium mt-5 mb-3">Features</h3>
        <ol class="list-disc px-5 space-y-2">
          {entry.data.features.map((feature) => <li>{feature}</li>)}
        </ol>
      </div>
      <div>
        <h3 class="text-3xl font-medium mt-5 mb-3">Challenges</h3>
        <ol class="list-disc px-5 space-y-2">
          {entry.data.challenges.map((challenge) => <li>{challenge}</li>)}
        </ol>
      </div>
    </section>
    <section class="grid grid-cols-1">
      <div>
        <h3 class="text-3xl font-medium mt-5 mb-3">Learnings</h3>
        <ol class="list-disc px-5 space-y-2">
          {entry.data.learnings.map((learning) => <li>{learning}</li>)}
        </ol>
      </div>
    </section>
    <section class="lg:w-1/4 grid grid-cols-2 mt-5 gap-3">
      <Button
        href={entry.data.projectURL}
        target="_blank"
        variant="primary"
        label="Live Demo"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="mr-1"
          width="20"
          height="20"
          fill="#fafafa"
          viewBox="0 0 256 256"
          ><path
            d="M128,24h0A104,104,0,1,0,232,128,104.12,104.12,0,0,0,128,24Zm88,104a87.61,87.61,0,0,1-3.33,24H174.16a157.44,157.44,0,0,0,0-48h38.51A87.61,87.61,0,0,1,216,128ZM102,168H154a115.11,115.11,0,0,1-26,45A115.27,115.27,0,0,1,102,168Zm-3.9-16a140.84,140.84,0,0,1,0-48h59.88a140.84,140.84,0,0,1,0,48ZM40,128a87.61,87.61,0,0,1,3.33-24H81.84a157.44,157.44,0,0,0,0,48H43.33A87.61,87.61,0,0,1,40,128ZM154,88H102a115.11,115.11,0,0,1,26-45A115.27,115.27,0,0,1,154,88Zm52.33,0H170.71a135.28,135.28,0,0,0-22.3-45.6A88.29,88.29,0,0,1,206.37,88ZM107.59,42.4A135.28,135.28,0,0,0,85.29,88H49.63A88.29,88.29,0,0,1,107.59,42.4ZM49.63,168H85.29a135.28,135.28,0,0,0,22.3,45.6A88.29,88.29,0,0,1,49.63,168Zm98.78,45.6a135.28,135.28,0,0,0,22.3-45.6h35.66A88.29,88.29,0,0,1,148.41,213.6Z"
          ></path></svg
        >
      </Button>
      <Button
        href={entry.data.githubURL}
        target="_blank"
        variant="secondary"
        label="GitHub"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="mr-1"
          width="20"
          height="20"
          fill="#222222"
          viewBox="0 0 256 256"
          ><path
            d="M208.31,75.68A59.78,59.78,0,0,0,202.93,28,8,8,0,0,0,196,24a59.75,59.75,0,0,0-48,24H124A59.75,59.75,0,0,0,76,24a8,8,0,0,0-6.93,4,59.78,59.78,0,0,0-5.38,47.68A58.14,58.14,0,0,0,56,104v8a56.06,56.06,0,0,0,48.44,55.47A39.8,39.8,0,0,0,96,192v8H72a24,24,0,0,1-24-24A40,40,0,0,0,8,136a8,8,0,0,0,0,16,24,24,0,0,1,24,24,40,40,0,0,0,40,40H96v16a8,8,0,0,0,16,0V192a24,24,0,0,1,48,0v40a8,8,0,0,0,16,0V192a39.8,39.8,0,0,0-8.44-24.53A56.06,56.06,0,0,0,216,112v-8A58.14,58.14,0,0,0,208.31,75.68ZM200,112a40,40,0,0,1-40,40H112a40,40,0,0,1-40-40v-8a41.74,41.74,0,0,1,6.9-22.48A8,8,0,0,0,80,73.83a43.81,43.81,0,0,1,.79-33.58,43.88,43.88,0,0,1,32.32,20.06A8,8,0,0,0,119.82,64h32.35a8,8,0,0,0,6.74-3.69,43.87,43.87,0,0,1,32.32-20.06A43.81,43.81,0,0,1,192,73.83a8.09,8.09,0,0,0,1,7.65A41.72,41.72,0,0,1,200,104Z"
          ></path></svg
        >
      </Button>
    </section>
  </main>
</BaseLayout>
