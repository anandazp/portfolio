---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import { render } from "astro:content";

import BaseLayout from "../../layouts/BaseLayout.astro"
import Header from "../../components/Header.astro";
import MiniCard from "../../components/ui/MiniCard.astro";
import Button from "../../components/ui/Button.astro";
import { Image } from "astro:assets";

export const getStaticPaths = (async () => {
    const projects = await getCollection('projects')

    return projects.map(entry =>({
        params : {slug : entry.slug},
        props : {entry},
    }))
    
}) satisfies GetStaticPaths;

const {entry} = Astro.props;
const { Content } = await render(entry);
---

<BaseLayout title={entry.data.title}>
    <Header/>
    <main class="px-5 md:px-10 py-5 mt-5 text-blackdark space-y-3">
        <a href="/" class="inline-flex items-center bg-blackdark text-whitelight px-2 py-1.5 gap-2 rounded-sm cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#eceff4" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path></svg>
            Back to projects</a>
        <Image src={entry.data.image} alt={entry.data.alt} class="rounded mt-2"/>
        <h1 class="text-4xl lg:text-5xl font-bold mt-5 mb-3">{entry.data.title}</h1>
        <h2 class="text-lg lg:text-xl">{entry.data.description}</h2>
        <div>
            <h3 class="text-3xl font-semibold mt-5 mb-3">Overview</h3>
            <Content/>
        </div>
        <h3 class="text-3xl font-semibold mt-5 mb-3">Tech Stack</h3>
        <div class="flex flex-wrap gap-2">
            {entry.data.tech.map(t =>(
                <MiniCard label={t} />
            ))}
        </div>
        <section class="grid grid-cols-1 md:grid-cols-2">
            <div>
                <h3 class="text-3xl font-semibold mt-5 mb-3">Features</h3>
                <ol class="list-disc px-5 space-y-2">
                {entry.data.features.map(feature => (
                    <li>{feature}</li>
                ))}
                </ol>
            </div>
            <div>
                <h3 class="text-3xl font-semibold mt-5 mb-3">Challenges</h3>
                <ol class="list-disc px-5 space-y-2">
                {entry.data.challenges.map(challenge => (
                    <li>{challenge}</li>
                ))}
                </ol>
            </div>
        </section>
        <section class="grid grid-cols-1">
            <div>
                <h3 class="text-3xl font-semibold mt-5 mb-3">Learnings</h3>
                <ol class="list-disc px-5 space-y-2">
                {entry.data.learnings.map(learning => (
                    <li>{learning}</li>
                ))}
                </ol>
            </div>
        </section>
        <section class="lg:w-1/4 grid grid-cols-2 mt-5 gap-3">
            <Button href={entry.data.projectURL} target="_blank" variant="primary" label="Live Demo">
                <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" width="20" height="20" fill="#eceff4" viewBox="0 0 256 256"><path d="M200,64V168a8,8,0,0,1-16,0V83.31L69.66,197.66a8,8,0,0,1-11.32-11.32L172.69,72H88a8,8,0,0,1,0-16H192A8,8,0,0,1,200,64Z"></path></svg>
            </Button>
            <Button href={entry.data.githubURL} target="_blank" variant="secondary" label="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" width="20" height="20" fill="#2c2c2c" viewBox="0 0 256 256"><path d="M200,64V168a8,8,0,0,1-16,0V83.31L69.66,197.66a8,8,0,0,1-11.32-11.32L172.69,72H88a8,8,0,0,1,0-16H192A8,8,0,0,1,200,64Z"></path></svg>
            </Button>
        </section>
    </main>
</BaseLayout>